from bokeh.plotting import figure, show
import numpy as np
from bokeh.models import WheelPanTool, WheelZoomTool
from bokeh.models.tickers import FixedTicker


Peak_positions= [71.08997799999999, 70.08380299999999, 69.07762799999999, 68.07145299999999, 67.06527799999999, 66.059103, 68.07145299999998, 67.06527799999998, 66.05910299999998, 65.05292799999998, 70.09294399999999, 69.08676899999999, 68.08059399999999, 67.07441899999999, 66.06824399999999, 65.062069, 66.06824399999998, 65.06206899999998, 64.05589399999998, 70.08662299999999, 69.08044799999999, 68.07427299999999, 67.06809799999999, 66.061923, 65.055748, 66.06192299999998, 65.05574799999998, 64.04957299999998, 69.089589, 68.083414, 67.077239, 66.071064, 68.08341399999999, 67.07723899999999, 66.07106399999999, 65.064889, 64.058714, 64.05871399999998, 63.05253899999998, 70.08994799999999, 69.083773, 68.077598, 67.071423, 66.065248, 65.059073, 66.06524799999998, 65.05907299999998, 64.05289799999998, 69.092914, 68.086739, 67.080564, 66.074389, 65.068214, 66.07438899999998, 65.06821399999998, 64.06203899999998, 63.05586399999998, 69.08659300000001, 68.08041800000001, 67.07424300000001, 66.06806800000001, 68.080418, 67.074243, 66.068068, 65.061893, 64.055718, 64.05571799999998, 63.049542999999986, 68.089559, 67.083384, 66.077209, 65.071034, 64.064859, 64.06485899999998, 63.058683999999985, 62.05250899999998, 69.085733, 68.079558, 67.073383, 66.06720800000001, 68.07955799999999, 67.07338299999999, 66.067208, 65.061033, 64.054858, 64.05485799999998, 63.04868299999998, 68.088699, 67.082524, 66.07634900000001, 65.07017400000001, 66.076349, 65.070174, 64.063999, 63.05782399999999, 62.05164899999998, 68.082378, 67.076203, 66.07002800000001, 65.06385300000001, 66.070028, 65.063853, 64.057678, 63.05150299999999, 62.045327999999984, 67.085344, 66.07916900000001, 65.07299400000001, 64.06681900000001, 64.066819, 63.060643999999996, 62.05446899999999, 61.048293999999984, 69.083268, 68.077093, 67.070918, 66.064743, 68.07709299999999, 67.07091799999999, 66.06474299999999, 65.058568, 64.052393, 64.05239299999998, 63.04621799999998, 68.086234, 67.080059, 66.073884, 65.06770900000001, 66.07388399999999, 65.067709, 64.061534, 63.05535899999999, 62.04918399999998, 68.08323800000001, 67.07706300000001, 66.07088800000001, 65.06471300000001, 66.070888, 65.064713, 64.058538, 63.05236299999999, 62.04618799999999, 67.08620400000001, 66.08002900000001, 65.07385400000001, 66.080029, 65.073854, 64.067679, 63.06150399999999, 62.055328999999986, 61.04915399999998, 66.079169, 65.072994, 63.06064399999999, 62.05446899999998, 61.04829399999998, 67.079023, 66.07284800000001, 65.06667300000001, 64.06049800000001, 64.060498, 63.054323, 62.04814799999999, 61.041972999999984, 66.08198900000001, 65.07581400000001, 64.06963900000001, 64.069639, 63.063463999999996, 62.05728899999999, 61.051113999999984, 60.04493899999998]
Peak_intensities= [1.0199165624999997e-32, 4.0790543000625e-28, 6.797404069862485e-24, 5.739169098923916e-20, 2.416129778340664e-16, 4.026278931456523e-13, 3.020615315223114e-21, 6.040324445851662e-17, 4.026278931456523e-13, 8.945944421370677e-10, 2.7463320843749995e-30, 1.0983680538249375e-25, 1.830338831028107e-21, 1.6267238046252914e-17, 7.590239048254789e-14, 1.4455429547423907e-10, 5.421599320181991e-15, 7.227714773711952e-11, 2.408876872165299e-07, 1.8339954187499995e-30, 7.334881277748749e-26, 1.2222968409261814e-21, 1.0863231079111493e-17, 5.0687474107431537e-14, 9.653308759298184e-11, 3.6205338648165415e-15, 4.8266543796490926e-11, 1.6086434604973819e-07, 4.938404420812498e-28, 9.875327320298754e-24, 6.582564014133808e-20, 1.4625725843403753e-16, 9.875327320298755e-24, 2.633025605653522e-19, 2.7788879102467135e-15, 1.4623531984527248e-11, 3.249186323273236e-08, 6.498372646546473e-09, 4.331598593766328e-05, 2.0398331249999994e-33, 8.158108600125e-29, 1.3594808139724972e-24, 1.2082461260892452e-20, 5.63763614946155e-17, 1.0736743817217395e-13, 4.0268829639011075e-18, 5.368371908608697e-14, 1.7891888842741352e-10, 5.492664168749999e-31, 2.196736107649875e-26, 3.660677662056212e-22, 2.6027580874004652e-18, 6.505919184218389e-15, 6.506895218501164e-19, 9.758878776327583e-15, 4.336628864227171e-11, 4.817753744330597e-08, 3.6679908375e-31, 7.334881277748751e-27, 4.8891873637047255e-23, 1.0863231079111489e-19, 7.334881277748751e-27, 1.9556749454818895e-22, 2.064013905031181e-18, 1.0861601594449625e-14, 2.4133271898245466e-11, 4.826654379649092e-12, 3.217286920994764e-08, 9.876808841624997e-29, 3.9501309281195025e-24, 6.582564014133808e-20, 5.850290337361499e-16, 1.9498042646036322e-12, 9.749021323018161e-13, 7.798047175855767e-09, 8.663197187532656e-06, 5.0873438137499986e-30, 1.0173161424355875e-25, 6.781090300094815e-22, 1.506682919233289e-18, 1.0173161424355874e-25, 2.712436120037926e-21, 2.862697546543249e-17, 1.5064569167954045e-13, 3.3471798850175226e-10, 6.694359770035045e-11, 4.462237077379694e-07, 1.3698704436862495e-27, 5.478659852478787e-23, 5.477838053500918e-19, 1.6228196674941901e-15, 3.651892035667278e-19, 6.491278669976758e-15, 4.0564406113601655e-11, 1.0815552387382565e-07, 0.0001201547783836051, 9.147969148724998e-28, 3.6586387813410755e-23, 3.6580899855238756e-19, 1.083715932452162e-15, 2.438726657015917e-19, 4.3348637298086505e-15, 2.708883437655735e-11, 7.2226056137069e-08, 8.02391358096094e-05, 2.4632761251012744e-25, 6.567751023153359e-21, 8.755687813999847e-17, 3.647656025344895e-13, 1.0942968076034689e-12, 3.647108876941094e-09, 9.724164828292142e-06, 0.010803006892853222, 8.244643041562496e-29, 1.6486812690212527e-24, 1.0989559778872665e-20, 2.4417580766457412e-17, 1.6486812690212529e-24, 4.3958239115490655e-20, 4.639340345626908e-16, 2.441391812934245e-12, 5.424501342582899e-09, 1.08490026851658e-09, 7.231583556508684e-06, 2.2200372600834367e-26, 8.878817017977697e-22, 8.877485195425001e-18, 2.629971428932056e-14, 5.918323463616668e-18, 1.0519885715728221e-13, 6.57394233304429e-10, 1.7527883311184894e-06, 0.0019472504587431355, 1.6489286083124998e-29, 6.594725076085012e-25, 6.5937358673235994e-21, 1.9534064613165928e-17, 4.3958239115490665e-21, 7.813625845266373e-17, 4.88278362586849e-13, 1.3018803222198958e-09, 1.4463167113017368e-06, 4.4400745201668744e-27, 5.919211345318466e-23, 1.9727744878722229e-19, 1.1838422690636932e-22, 2.7618842830211127e-18, 2.6299714289320565e-14, 1.314788466608858e-10, 3.50557666223698e-07, 0.0003894500917486272, 3.283875511576679e-21, 7.661226837249866e-17, 3.647108876941094e-09, 9.724164828292142e-06, 0.010803006892853222, 4.1124279491313725e-26, 1.6447244339756019e-21, 2.7407962088508432e-17, 1.2179489286308954e-13, 1.2179489286308957e-13, 1.2177662362916013e-09, 3.246889523616421e-06, 0.0036071138779865315, 1.1073545853296182e-23, 4.428753928567274e-19, 2.4600497863766615e-15, 4.920099572753322e-15, 6.55914874375655e-11, 3.2790824357224917e-07, 0.0008742908195619027, 0.971288528821076]

#precision parameter
x = 0.004

mass_range = np.linspace(min(Peak_positions)-1, max(Peak_positions)+1, 1000)

intensity = np.zeros_like(mass_range)

for peak_position, peak_intensity in zip(Peak_positions, Peak_intensities):

    peak_shape = peak_intensity * np.exp(-((mass_range - peak_position) ** 2) / (2 * x ** 2))  # Gaussian example

    intensity += peak_shape


ticked_peaked = []
for i in peak_position:
    if i > 10**(-5):
       ticked_peaked.append(i)
print(ticked_peaked)

# Create a new plot with a title and axis labels
p = figure(title="Simulated Mass Spectrum", x_axis_label='Mass [Th]', y_axis_label='Intensity')
p = figure(width=700 , title= f'Mass spectrum of molecule')
p.height = 500
p.xaxis.ticker = FixedTicker(ticks= ticked_peaked)
p.toolbar.autohide = True
p.add_tools(WheelPanTool(dimension="height"))
p.add_tools(WheelZoomTool(dimensions="height"))

# Add a line renderer with legend and line thickness
p.line(mass_range, intensity, legend_label="Intensity", line_width=1)

# Show the plot
show(p)









